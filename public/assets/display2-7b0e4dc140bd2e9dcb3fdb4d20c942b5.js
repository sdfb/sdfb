function createGroup(){this.id=null,this.name=null,this.nodes=null}function createNodeKey(t){var e={text:t.first+" "+t.last,size:4,id:t.id,cluster:getClusterRels(t)};return e}function getSize(t){var e=t.size,n=t.size;return 0==e?n=14:(n=4*e,n>80&&(n=80)),n}function getClusterBirth(t){if(parseInt(t)<1550)return 0;if(parseInt(t)>1700)return 1;var e=Math.round((parseInt(t)-1550)/5);return 2+e}function getColorsBirth(){return{0:"#A6D9CA",1:"#F0623E",2:"#B99CCA",3:"#B8DCF4",4:"#F9F39C",5:"#339998",6:"#6566AD",7:"#F89939",8:"#558FCB",9:"#04A287",10:"#B53C84",11:"#F2805C",12:"#79BD90",13:"#654B9E",14:"#DD88B8",15:"#3D58A6",16:"#EF4C3A",17:"#99CC7D",18:"#4D6AB2",19:"#A1D7D0",20:"#FABC3E",21:"#EE6096",22:"#DADC44",23:"#B177B3",24:"#A573B1",25:"#78CDD6",26:"#60BD6D",27:"#3EA7C0",28:"#F59485",29:"#3F6FB6",30:"#F8EC49",31:"#1C57A7"}}function getClusterRels(t){var e=getSize(t);return e>11?6:Math.floor(e/2)}function getColorsRels(){return{0:"#f56046",1:"#ffbb12",2:"#73cab5",3:"#1d7578",4:"#b6dcf2",5:"#ff00ff",6:"#9954e2"}}function notInArray(t,e){for(var n=t.length;n--;){if(t[n][0]==e[0]&&t[n][1]==e[1])return!1;if(t[n][1]==e[0]&&t[n][0]==e[1])return!1}return!0}function showNodeInfo(t,e){accordion("node"),$("#node-name").text(t.first+" "+t.last),$("#node-bdate").text(t.birth),$("#node-ddate").text(t.death),$("#node-significance").text(t.occupation),$("#node-group").text(e);var n=new Date;$("#node-cite").text(t.first+" "+t.last+" Network Visualization. \n Six Degrees of Francis Bacon: Reassembling the Early Modern Social Network. Gen. eds. Daniel Shore and Christopher Warren. "+n.getMonth()+"/"+n.getDate()+"/"+n.getFullYear()+" <http://sixdegreesoffrancisbacon.com/>"),console.log(t.odnb_id),t.odnb_id>0?$("#node-DNBlink").attr("href","http://www.oxforddnb.com/view/article/"+t.odnb_id):$("#node-DNBlink").attr("href","http://www.oxforddnb.com/search/quick/?quicksearch=quicksearch&docPos=1&searchTarget=people&simpleName="+t.first+"+"+t.last),$("#node-GoogleLink").attr("href","http://www.google.com/search?q="+t.first+"+"+t.last),$("#node-discussion").attr("href","/people/"+t.id),$("#node-icon-chain").attr("href","/relationships/new?person1_id="+t.id),$("#node-icon-annotate").attr("href","/user_person_contribs/new?person_id="+t.id)}function twoDegs(t,e){function n(t,e){var n=[];for(var i in e.groups)e.groups[i].nodes.indexOf(t.id)>-1&&n.push(e.groups[i].name);var o=n.join(", ");return o}var i=e.nodes[t],o={},r=[],s=[];i.rels.length>0&&($.each(i.rels,function(t,n){if(0==n[2]||n[1]<.75);else{var r=e.nodes[n[0]];o[r.id]=createNodeKey(r),notInArray(s,[i.id,r.id])&&s.push([i.id,r.id]),r&&r.rels.length>0&&$.each(r.rels,function(t,n){if(0!=n[2]&&n[1]>=.75){var i=e.nodes[n[0]];o[i.id]=createNodeKey(i),notInArray(s,[r.id,i.id])&&s.push([r.id,i.id]),i&&i.rels.length>0&&$.each(i.rels,function(t,n){if(0!=n[2]&&n[1]>=.75){var r=e.nodes[n[0]];o[r.id]=createNodeKey(r),r&&r.id in o&&notInArray(s,[i.id,r.id])&&s.push([i.id,r.id])}})}})}}),o[i.id]={text:i.first+" "+i.last,size:20,id:i.id,cluster:getClusterRels(i)}),$.each(o,function(t,e){r.push(e)}),s.reverse(),$("#results").html("Two degrees of <b>"+i.label);var a=window.innerWidth,l=window.innerHeight,c={width:a,height:l,collisionAlpha:10,colors:getColorsRels()},u=new Insights($("#graph")[0],r,s,c).render(),d=window.location.search;if(null!=d&&"id"==d.substring(1,3)){$("#landing").fadeOut(),$("#everything").fadeIn();var h=d.substring(4),p=e.nodes[h];showNodeInfo(p,n(p,e)),u.focus(h).update()}u.on("node:click",function(t){var i=e.nodes[t.id];showNodeInfo(i,n(i,e))}),u.on("edge:click",function(t){Pace.restart();var n=parseInt(t.source.id),i=parseInt(t.target.id);getAnnotation(i>n?n:i,n>i?n:i,e)}),u.tooltip("<div class='btn' >{{text}}</div>"),$("#zoom button.icon").click(function(){"in"==this.name?(u.zoomIn(),u.center()):"out"==this.name&&(u.zoomOut(),u.center())})}function writeGroupTable(t,e){$("#graph").html('<table cellpadding="0" cellspacing="0" border="0" class="display table table-bordered table-striped" id="data-table-container"></table>'),$("#data-table-container").dataTable({sPaginationType:"bootstrap",iDisplayLength:100,aaData:t,aoColumns:[{mDataProp:"first",sTitle:"First Name"},{mDataProp:"last",sTitle:"Last Name"},{mDataProp:"birth",sTitle:"Birth Date"},{mDataProp:"death",sTitle:"Death Date"},{mDataProp:"occupation",sTitle:"Historical Significance"}],oLanguage:{sLengthMenu:"_MENU_ records per page"}}),downloadData(t,e)}function writeGroupTable(t,e){$("#graph").html('<table cellpadding="0" cellspacing="0" border="0" class="display table table-bordered table-striped" id="data-table-container"></table>'),$("#data-table-container").dataTable({sPaginationType:"bootstrap",iDisplayLength:100,aaData:t,aoColumns:[{mDataProp:"first",sTitle:"First Name"},{mDataProp:"last",sTitle:"Last Name"},{mDataProp:"birth",sTitle:"Birth Date"},{mDataProp:"death",sTitle:"Death Date"},{mDataProp:"occupation",sTitle:"Historical Significance"}],oLanguage:{sLengthMenu:"_MENU_ records per page"}}),downloadData(t,e)}function writeNetworkTable(t){$("#graph").html('<table cellpadding="0" cellspacing="0" border="0" class="display table table-bordered table-striped" id="data-table-container"></table>'),$("#data-table-container").dataTable({sPaginationType:"bootstrap",iDisplayLength:100,aaData:t,aoColumns:[{mDataProp:"network",sTitle:"Network"}],oLanguage:{sLengthMenu:"_MENU_ records per page"}})}function getConfidence(t){return.19>=(t>=0)?"very unlikely":.39>=(t>=.2)?"unlikely":.59>=(t>=.4)?"possible":.79>=(t>=.6)?"likely":1>=(t>=.8)?"certain":void 0}function getAnnotation(t,e,n){var i=n.nodes[t].rels,o="",r="";return $.each(i,function(t,n){n[0]==e&&(o=getConfidence(n[1])+" @ "+100*n[1]+"%",r=n[3])}),accordion("edge"),$("#edge-nodes").html(n.nodes[t].first+" "+n.nodes[t].last+" & "+n.nodes[e].first+" "+n.nodes[e].last),$("#edge-confidence").html(o),$("#edge-discussion").attr("href","/relationships/"+r),$("#edge-icon-annotate").attr("href","/user_rel_contribs/new?relationship_id="+r),!0}function downloadData(t,e){var n=e+" \nFirst Name,Last Name,Birth Date,Death Date,Historical Significance\n";t.forEach(function(t){n+=t.first+","+t.last+","+t.birth+","+t.death+","+t.occupation+"\n"});var i=$('<a href="data:text/csv;charset=utf-8,'+encodeURIComponent(n)+' "download="'+e+'.csv"><div id="download"></div></a>');$(i).appendTo("#graph")}function populateLists(t){$("#one").typeahead({local:Object.keys(t.nodes_names).sort()}),$("#two").typeahead({local:Object.keys(t.nodes_names).sort()}),$("#three").typeahead({local:Object.keys(t.nodes_names).sort()}),$("#entry_768090773").typeahead({local:Object.keys(t.nodes_names).sort()}),$("#entry_1321382891").typeahead({local:Object.keys(t.nodes_names).sort()}),$("#entry_1177061505").typeahead({local:Object.keys(t.nodes_names).sort()}),$("#four").typeahead({local:Object.keys(t.groups_names).sort()}),$("#five").typeahead({local:Object.keys(t.groups_names).sort()}),$("#six").typeahead({local:Object.keys(t.groups_names).sort()}),$("#entry_110233074").typeahead({local:Object.keys(t.groups_names).sort()})}function resetInputs(){$("#one").val(""),$("#one").typeahead("setQuery",""),$("#two").val(""),$("#two").typeahead("setQuery",""),$("#three").val(""),$("#three").typeahead("setQuery",""),$("#four").val(""),$("#four").typeahead("setQuery",""),$("#five").val(""),$("#five").typeahead("setQuery",""),$("#six").val(""),$("#six").typeahead("setQuery",""),document.getElementById("googleaddnode").reset(),document.getElementById("googleaddedge").reset(),document.getElementById("googleaddgroup").reset()}function init(){var t=gon.people,e={nodes:[],edges:[],nodes_names:[],groups_names:[],nodeKeys:[]};$.each(t,function(t,n){var i=new node;i.id=n.id,i.first=n.first_name,i.last=n.last_name,i.label=i.first+" "+i.last,i.birth=n.ext_birth_year,i.death=n.ext_death_year,i.occupation=n.historical_significance,i.rels=n.rel_sum,i.size=i.rels.length,i.odnb_id=n.odnb_id,e.nodes[i.id]=i}),twoDegs(francisID,e),populateLists(e)}var francisID=10000473,node=function(){this.id=null,this.first=null,this.last=null,this.birth=null,this.death=null,this.label=null,this.name=null,this.occupation=null,this.edges=[],this.key=null,this.rels=0,this.size=0};$("#zoom button.icon").click(function(){"in"==this.name?graph.zoomIn():graph.zoomOut()}),$(document).ready(function(){init()});