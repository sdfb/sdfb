/*! jQuery-Impromptu - v5.2.3 - 2014-03-09
* http://trentrichardson.com/Impromptu
* Copyright (c) 2014 Trent Richardson; Licensed MIT */
!function(t){"use strict";t.prompt=function(n,e){void 0!==e&&void 0!==e.classes&&"string"==typeof e.classes&&(e={box:e.classes}),t.prompt.options=t.extend({},t.prompt.defaults,e),t.prompt.currentPrefix=t.prompt.options.prefix,t.prompt.timeout&&clearTimeout(t.prompt.timeout),t.prompt.timeout=!1;var r=t.prompt.options,i=t(document.body),o=t(window),a='<div class="'+t.prompt.options.prefix+"box "+r.classes.box+'">';a+=r.useiframe&&t("object, applet").length>0?'<iframe src="javascript:false;" style="display:block;position:absolute;z-index:-1;" class="'+r.prefix+"fade "+r.classes.fade+'"></iframe>':'<div class="'+r.prefix+"fade "+r.classes.fade+'"></div>',a+='<div class="'+r.prefix+" "+r.classes.prompt+'"><form action="javascript:false;" onsubmit="return false;" class="'+r.prefix+'form"><div class="'+r.prefix+"close "+r.classes.close+'">'+r.closeText+'</div><div class="'+r.prefix+'states"></div></form></div></div>',t.prompt.jqib=t(a).appendTo(i),t.prompt.jqi=t.prompt.jqib.children("."+r.prefix),t.prompt.jqif=t.prompt.jqib.children("."+r.prefix+"fade"),n.constructor===String&&(n={state0:{title:r.title,html:n,buttons:r.buttons,position:r.position,focus:r.focus,defaultButton:r.defaultButton,submit:r.submit}}),t.prompt.options.states={};var u,s;for(u in n)s=t.extend({},t.prompt.defaults.state,{name:u},n[u]),t.prompt.addState(s.name,s),""===t.prompt.currentStateName&&(t.prompt.currentStateName=s.name);t.prompt.jqi.on("click","."+r.prefix+"buttons button",function(){var n=t(this),e=n.parents("."+r.prefix+"state"),i=t.prompt.options.states[e.data("jqi-name")],o=e.children("."+r.prefix+"message"),a=i.buttons[n.text()]||i.buttons[n.html()],u={};if(void 0===a)for(var s in i.buttons)(i.buttons[s].title===n.text()||i.buttons[s].title===n.html())&&(a=i.buttons[s].value);t.each(t.prompt.jqi.children("form").serializeArray(),function(t,n){void 0===u[n.name]?u[n.name]=n.value:typeof u[n.name]===Array||"object"==typeof u[n.name]?u[n.name].push(n.value):u[n.name]=[u[n.name],n.value]});var l=new t.Event("impromptu:submit");l.stateName=i.name,l.state=e,e.trigger(l,[a,o,u]),l.isDefaultPrevented()||t.prompt.close(!0,a,o,u)});var l=function(){if(r.persistent){var n=(""+r.top).indexOf("%")>=0?o.height()*(parseInt(r.top,10)/100):parseInt(r.top,10),e=parseInt(t.prompt.jqi.css("top").replace("px",""),10)-n;t("html,body").animate({scrollTop:e},"fast",function(){var n=0;t.prompt.jqib.addClass(r.prefix+"warning");var e=setInterval(function(){t.prompt.jqib.toggleClass(r.prefix+"warning"),n++>1&&(clearInterval(e),t.prompt.jqib.removeClass(r.prefix+"warning"))},100)})}else t.prompt.close(!0)},c=function(n){var e=window.event?event.keyCode:n.keyCode;if(27===e&&l(),13===e){var i=t.prompt.getCurrentState().find("."+r.prefix+"defaultbutton"),o=t(n.target);o.is("textarea,."+r.prefix+"button")===!1&&i.length>0&&(n.preventDefault(),i.click())}if(9===e){var a=t("input,select,textarea,button",t.prompt.getCurrentState()),u=!n.shiftKey&&n.target===a[a.length-1],s=n.shiftKey&&n.target===a[0];if(u||s)return setTimeout(function(){if(a){var t=a[s===!0?a.length-1:0];t&&t.focus()}},10),!1}};return t.prompt.position(),t.prompt.style(),t.prompt.jqif.click(l),o.resize({animate:!1},t.prompt.position),t.prompt.jqi.find("."+r.prefix+"close").click(t.prompt.close),t.prompt.jqib.on("keydown",c).on("impromptu:loaded",r.loaded).on("impromptu:close",r.close).on("impromptu:statechanging",r.statechanging).on("impromptu:statechanged",r.statechanged),t.prompt.jqif[r.show](r.overlayspeed),t.prompt.jqi[r.show](r.promptspeed,function(){var n=t.prompt.jqi.find("."+r.prefix+"states ."+r.prefix+"state").eq(0);t.prompt.goToState(n.data("jqi-name")),t.prompt.jqib.trigger("impromptu:loaded")}),r.timeout>0&&(t.prompt.timeout=setTimeout(function(){t.prompt.close(!0)},r.timeout)),t.prompt.jqib},t.prompt.defaults={prefix:"jqi",classes:{box:"",fade:"",prompt:"",close:"",title:"",message:"",buttons:"",button:"",defaultButton:""},title:"",closeText:"&times;",buttons:{Ok:!0},loaded:function(){},submit:function(){},close:function(){},statechanging:function(){},statechanged:function(){},opacity:.6,zIndex:999,overlayspeed:"slow",promptspeed:"fast",show:"fadeIn",focus:0,defaultButton:0,useiframe:!1,top:"15%",position:{container:null,x:null,y:null,arrow:null,width:null},persistent:!0,timeout:0,states:{},state:{name:null,title:"",html:"",buttons:{Ok:!0},focus:0,defaultButton:0,position:{container:null,x:null,y:null,arrow:null,width:null},submit:function(){return!0}}},t.prompt.currentPrefix=t.prompt.defaults.prefix,t.prompt.currentStateName="",t.prompt.setDefaults=function(n){t.prompt.defaults=t.extend({},t.prompt.defaults,n)},t.prompt.setStateDefaults=function(n){t.prompt.defaults.state=t.extend({},t.prompt.defaults.state,n)},t.prompt.position=function(n){var e=t.fx.off,r=t.prompt.getCurrentState(),i=t.prompt.options.states[r.data("jqi-name")],o=i?i.position:void 0,a=t(window),u=document.body.scrollHeight,s=t(window).height(),l=(t(document).height(),u>s?u:s),c=parseInt(a.scrollTop(),10)+((""+t.prompt.options.top).indexOf("%")>=0?s*(parseInt(t.prompt.options.top,10)/100):parseInt(t.prompt.options.top,10));if(void 0!==n&&n.data.animate===!1&&(t.fx.off=!0),t.prompt.jqib.css({position:"absolute",height:l,width:"100%",top:0,left:0,right:0,bottom:0}),t.prompt.jqif.css({position:"fixed",height:l,width:"100%",top:0,left:0,right:0,bottom:0}),o&&o.container){var f=t(o.container).offset();t.isPlainObject(f)&&void 0!==f.top&&(t.prompt.jqi.css({position:"absolute"}),t.prompt.jqi.animate({top:f.top+o.y,left:f.left+o.x,marginLeft:0,width:void 0!==o.width?o.width:null}),c=f.top+o.y-((""+t.prompt.options.top).indexOf("%")>=0?s*(parseInt(t.prompt.options.top,10)/100):parseInt(t.prompt.options.top,10)),t("html,body").animate({scrollTop:c},"slow","swing",function(){}))}else o&&o.width?(t.prompt.jqi.css({position:"absolute",left:"50%"}),t.prompt.jqi.animate({top:o.y||c,left:o.x||"50%",marginLeft:-1*(o.width/2),width:o.width})):t.prompt.jqi.css({position:"absolute",top:c,left:"50%",marginLeft:-1*(t.prompt.jqi.outerWidth(!1)/2)});void 0!==n&&n.data.animate===!1&&(t.fx.off=e)},t.prompt.style=function(){t.prompt.jqif.css({zIndex:t.prompt.options.zIndex,display:"none",opacity:t.prompt.options.opacity}),t.prompt.jqi.css({zIndex:t.prompt.options.zIndex+1,display:"none"}),t.prompt.jqib.css({zIndex:t.prompt.options.zIndex})},t.prompt.get=function(){return t("."+t.prompt.currentPrefix)},t.prompt.addState=function(n,e,r){var i,o,a,u="",s=null,l="",c="",f=t.prompt.options,h=t("."+t.prompt.currentPrefix+"states"),p=0;e=t.extend({},t.prompt.defaults.state,{name:n},e),null!==e.position.arrow&&(l='<div class="'+f.prefix+"arrow "+f.prefix+"arrow"+e.position.arrow+'"></div>'),e.title&&""!==e.title&&(c='<div class="lead '+f.prefix+"title "+f.classes.title+'">'+e.title+"</div>"),u+='<div id="'+f.prefix+"state_"+n+'" class="'+f.prefix+'state" data-jqi-name="'+n+'" style="display:none;">'+l+c+'<div class="'+f.prefix+"message "+f.classes.message+'">'+e.html+'</div><div class="'+f.prefix+"buttons "+f.classes.buttons+'"'+(t.isEmptyObject(e.buttons)?'style="display:none;"':"")+">";for(o in e.buttons)a=e.buttons[o],i=e.focus===p||isNaN(e.focus)&&e.defaultButton===p?t.prompt.currentPrefix+"defaultbutton "+f.classes.defaultButton:"","object"==typeof a?(u+='<button class="'+f.classes.button+" "+t.prompt.currentPrefix+"button "+i,void 0!==a.classes&&(u+=" "+(t.isArray(a.classes)?a.classes.join(" "):a.classes)+" "),u+='" name="'+f.prefix+"_"+n+"_button"+a.title.replace(/[^a-z0-9]+/gi,"")+'" id="'+f.prefix+"_"+n+"_button"+a.title.replace(/[^a-z0-9]+/gi,"")+'" value="'+a.value+'">'+a.title+"</button>"):u+='<button class="'+t.prompt.currentPrefix+"button "+f.classes.button+" "+i+'" name="'+f.prefix+"_"+n+"_button"+o.replace(/[^a-z0-9]+/gi,"")+'" id="'+f.prefix+"_"+n+"_button"+o.replace(/[^a-z0-9]+/gi,"")+'" value="'+a+'">'+o+"</button>",p++;return u+="</div></div>",s=t(u),s.on("impromptu:submit",e.submit),void 0!==r?h.find("#"+t.prompt.currentPrefix+"state_"+r).after(s):h.append(s),t.prompt.options.states[n]=e,s},t.prompt.removeState=function(n){var e=t.prompt.getState(n),r=function(){e.remove()};return 0===e.length?!1:("none"!==e.css("display")?e.next().length>0?t.prompt.nextState(r):t.prompt.prevState(r):e.slideUp("slow",r),!0)},t.prompt.getState=function(n){return t("#"+t.prompt.currentPrefix+"state_"+n)},t.prompt.getStateContent=function(n){return t.prompt.getState(n)},t.prompt.getCurrentState=function(){return t.prompt.getState(t.prompt.getCurrentStateName())},t.prompt.getCurrentStateName=function(){return t.prompt.currentStateName},t.prompt.goToState=function(n,e,r){var i=(t.prompt.get(),t.prompt.options),o=t.prompt.getState(n),a=i.states[o.data("jqi-name")],u=new t.Event("impromptu:statechanging");return"function"==typeof e&&(r=e,e=!1),t.prompt.jqib.trigger(u,[t.prompt.getCurrentStateName(),n]),!u.isDefaultPrevented()&&o.length>0&&(t.prompt.jqi.find("."+t.prompt.currentPrefix+"parentstate").removeClass(t.prompt.currentPrefix+"parentstate"),e?(t.prompt.jqi.find("."+t.prompt.currentPrefix+"substate").not(o).slideUp(i.promptspeed).removeClass("."+t.prompt.currentPrefix+"substate").find("."+t.prompt.currentPrefix+"arrow").hide(),t.prompt.jqi.find("."+t.prompt.currentPrefix+"state:visible").addClass(t.prompt.currentPrefix+"parentstate"),o.addClass(t.prompt.currentPrefix+"substate")):t.prompt.jqi.find("."+t.prompt.currentPrefix+"state").not(o).slideUp(i.promptspeed).find("."+t.prompt.currentPrefix+"arrow").hide(),t.prompt.currentStateName=a.name,o.slideDown(i.promptspeed,function(){var e=t(this);"string"==typeof a.focus?e.find(a.focus).eq(0).focus():e.find("."+t.prompt.currentPrefix+"defaultbutton").focus(),e.find("."+t.prompt.currentPrefix+"arrow").show(i.promptspeed),"function"==typeof r&&t.prompt.jqib.on("impromptu:statechanged",r),t.prompt.jqib.trigger("impromptu:statechanged",[n]),"function"==typeof r&&t.prompt.jqib.off("impromptu:statechanged",r)}),e||t.prompt.position()),o},t.prompt.nextState=function(n){var e=t("#"+t.prompt.currentPrefix+"state_"+t.prompt.getCurrentStateName()).next();return e.length>0&&t.prompt.goToState(e.attr("id").replace(t.prompt.currentPrefix+"state_",""),n),e},t.prompt.prevState=function(n){var e=t("#"+t.prompt.currentPrefix+"state_"+t.prompt.getCurrentStateName()).prev();return e.length>0&&t.prompt.goToState(e.attr("id").replace(t.prompt.currentPrefix+"state_",""),n),e},t.prompt.close=function(n,e,r,i){t.prompt.timeout&&(clearTimeout(t.prompt.timeout),t.prompt.timeout=!1),t.prompt.jqib&&t.prompt.jqib.fadeOut("fast",function(){t.prompt.jqib.trigger("impromptu:close",[e,r,i]),t.prompt.jqib.remove(),t(window).off("resize",t.prompt.position)})},t.fn.prompt=function(n){void 0===n&&(n={}),void 0===n.withDataAndEvents&&(n.withDataAndEvents=!1),t.prompt(t(this).clone(n.withDataAndEvents).html(),n)}}(jQuery);