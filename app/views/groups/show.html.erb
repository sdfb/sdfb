<%- model_class = Group -%>

<div class="row">
  <div class="span12">
    <h1>Group: <%= @group.name %>
    </h1>
  </div>
</div>
<br>
<div class="row">
  <div class="span5">
    <div class="well">
      <h2>Information
        <% if can? :update, @group %> 
        <%= link_to t('.edit', :default => t("helpers.links.edit")),
                  edit_group_path(@group), :class => 'btn btn-mini' %>
        <% end %>
      </h2>
      <br>
      <dl class="dl-horizontal">
        <dt><strong><%= model_class.human_attribute_name(:created_by) %>:</strong></dt>
        <dd><%= link_to User.find(@group.created_by).username,  user_path(@group.created_by) %></dd>
        <dt><strong><%= model_class.human_attribute_name(:name) %>:</strong></dt>
        <dd><%= @group.name %></dd>
        <% if ! @group.description.blank? %>
          <dt>Description:</strong></dt>
          <dd><%= @group.description %></dd>
        <% end %>
        <% if ! @group.justification.blank? %>
          <dt>Justification</dt>
          <dd><%= @group.justification %></dd>
        <% end %>
        <dt><strong>Is Approved?:</strong></dt>
        <dd><%= @group.is_approved %></dd>
        <% if ! @group.approved_by.blank? %>
          <dt><strong>Approved by:</strong></dt>
          <dd><%= link_to User.find(@group.approved_by).username,  user_path(@group.approved_by) %></dd>
        <% end %>
        <% if ! @group.approved_on.blank? %>
          <dt><strong>Approved on:</strong></dt>
          <dd><%= @group.approved_on %></dd>
        <% end %>
        <dt>Created at</dt>
        <dd><%= @group.created_at %></dd>
        <% if ! @group.person_list.blank? %>
          <dt>Members</dt>
          <dd><%= @group.person_list %></dd>
        <% end %>
      </dl>
    </div>
  </div>
    <div class="span7">
      <% if ! @user_group_contribs.empty? %>
        <div class="well">
        <h2>All User Group Contibutions for <%= @group.name%> <%= link_to 'New User Group Contribution',
                    new_user_group_contrib_path(:group_id => @group.id),
                    :class => 'btn btn-primary btn-mini' %></h2>
        <table class="table table-condensed">
          <thead>
            <tr>
              <th>User Group Contribution id</th>
              <th>Group</th>
              <th>Annotation</th>
              <th>Bibliography</th>
              <th><%=t '.actions', :default => t("helpers.actions") %></th>
            </tr>
          </thead>
          <tbody>
            <% @user_group_contribs.each do |user_group_contrib| %>
              <tr>
                <td><%= user_group_contrib.id %></td>
                <td><%= link_to Group.find(user_group_contrib.group_id).name, group_path(user_group_contrib.group_id) %></td>
                <td><%= user_group_contrib.annotation %></td>
                <td><%= user_group_contrib.bibliography %></td>
                <td>
                  <% if can? :show, user_group_contrib %>
                      <%= link_to 'Show', user_group_contrib, :class => 'btn btn-mini' %>
                  <% end %>
                  <% if can? :update, user_group_contrib %>
                      <%= link_to t('.edit', :default => t("helpers.links.edit")),
                                edit_user_group_contrib_path(user_group_contrib), :class => 'btn btn-mini' %>
                  <% end %>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>

        <%= will_paginate @user_group_contribs, :param_name => 'user_group_contribs_page', :previous_label => "Previous&nbsp;", :next_label => "&nbsp;Next" %>
        </div>
      <% else %>
        <div class = "well">
          <h2>All User Group Contibutions for <%= @group.name%> <%= link_to 'New User Group Contribution',
                    new_user_group_contrib_path(:group_id => @group.id),
                    :class => 'btn btn-primary btn-mini' %></h2>
          <br>
          <b>No User Group Contributions exist.</b>
        </div>
      <% end %>

          <div class = "well">
      <h1>All Group Assignments for <%= @group.name%> <%= link_to 'New Group Assignment',
                    new_group_assignment_path(:group_id => @group.id),
                    :class => 'btn btn-primary btn-mini' %></h1>
      <% if ! @people.empty? %>
        <table class="table table-condensed">
          <thead>
          <tr>
            <th>Group Assignment id</th>
            <th>Person</th>
            <th>Start date</th>
            <th>End date</th>
            <th><%=t '.actions', :default => t("helpers.actions") %></th>
          </tr>
          </thead>
          <tbody>
            <% @people.each do |group_assignment| %>
              <tr>
                <td><%= group_assignment.id %></td>
                <td><%= link_to group_assignment.get_person_name, person_path(group_assignment.person_id) %></td>
                <td><%= group_assignment.start_date %></td>
                <td><%= group_assignment.end_date %></td>
                <td>
                  <% if can? :show, group_assignment %>
                    <%= link_to 'Show', group_assignment, :class => 'btn btn-mini' %>
                  <% end %>
                  <% if can? :update, group_assignment %>
                    <%= link_to 'Edit', edit_group_assignment_path(group_assignment), :class => 'btn btn-mini' %>
                  <% end %>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>

        <%= will_paginate @people, :param_name => 'people_page', :previous_label => "Previous&nbsp;", :next_label => "&nbsp;Next" %>
      <% else %>
        <br>
        <b>No Groups exist.</b>
      <% end %>
    </div>
    </div>
</div>

